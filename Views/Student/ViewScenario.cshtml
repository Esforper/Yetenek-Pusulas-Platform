@* Views/Student/ViewScenario.cshtml *@
@model YetenekPusulasi.Core.Interfaces.Entities.IScenario
@{
    ViewData["Title"] = Model.Title;
}

<h4>Senaryo: @Model.Title</h4>
@if (Model.WasInitialPromptAIGenerated)
{
    <small class="text-muted d-block mb-2">(Bu başlangıç metni yapay zeka tarafından sizin için özel olarak oluşturulmuştur)</small>
}
<hr />

@* BAŞLANGIÇ PROMPT'U GÖSTERİLİYOR *@
@if (!string.IsNullOrWhiteSpace(Model.InitialPrompt))
{
    <div class="alert alert-light mb-3" role="alert">
        <h5 class="alert-heading">Başlangıç</h5>
        <p>@Html.Raw(Model.InitialPrompt.Replace("\n", "<br />"))</p> @* Satır sonlarını <br>'ye çevir *@
    </div>
}

<div>
    <dl class="row">
        <dt class="col-sm-2">Senaryo Türü</dt>
        <dd class="col-sm-10">@Model.Type.ToString()</dd>

        <dt class="col-sm-2">Asıl Senaryo Açıklaması</dt>
        <dd class="col-sm-10">
            <p>@Model.Description</p>
        </dd>
    </dl>
</div>

<div class="mt-4 card">
    <div class="card-header">
        Cevabınız
    </div>
    <div class="card-body">
        @* TODO: Öğrenci bu senaryoya daha önce cevap verdiyse, formu gösterme veya farklı bir mesaj göster. *@
        <form asp-action="SubmitAnswer" asp-controller="Student" method="post">
            <input type="hidden" name="ScenarioId" value="@Model.Id" /> @* ViewModel'daki property adı ScenarioId olacak *@
            <div asp-validation-summary="ModelOnly" class="text-danger mb-2"></div> @* Sadece model seviyesi hatalar *@
            
            <div class="mb-3">
                <label for="AnswerText" class="form-label visually-hidden">Cevabınız</label>
                <textarea name="AnswerText" id="AnswerText" class="form-control" rows="8" placeholder="Senaryoya cevabınızı buraya yazınız..." required minlength="10"></textarea>
                @* ASP.NET Core MVC'de validation-for tag helper'ı kullanmak daha iyi olurdu eğer tam bir ViewModel'e bind ediyorsak *@
                @* <span asp-validation-for="AnswerText" class="text-danger"></span> *@
                <div class="invalid-feedback">Lütfen en az 10 karakterlik bir cevap girin.</div> @* Basit HTML5 validasyonu için *@
            </div>
            <button type="submit" class="btn btn-primary">Cevabı Gönder ve Analiz Et</button>
        </form>
    </div>
</div>


<div class="mt-3">
    @* Geri dönülecek sınıfın senaryo listesine link. ClassroomId'yi ViewBag veya ViewData ile taşımak gerekebilir. *@
    @* Veya bir önceki sayfaya dönme (javascript:history.back()) *@
    <a asp-action="ViewClassroomScenarios" asp-route-classroomId="@Model.ClassroomId" class="btn btn-outline-secondary">Sınıf Senaryolarına Geri Dön</a>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}